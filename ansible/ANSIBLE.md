# Ansible
## Best Practices
- Use config file `ansible.cfg`
- Use roles
- Use inventory
- Use defaults for variable storing

## Output of deployment command:
```angular2html
ansible-playbook -i inventory/default_aws_ec2.yml playbooks/dev/main.yml

PLAY [Docker] ****************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************************************************************************************************************************
ok: [vm01]

TASK [docker : include_tasks] ************************************************************************************************************************************************************************************************************************
included: /Users/art22m/develop/iu/F23-DevOps/ansible/roles/docker/tasks/install_pip.yml for vm01

TASK [docker : Install pip] **************************************************************************************************************************************************************************************************************************
^[[Dchanged: [vm01]

TASK [docker : include_tasks] ************************************************************************************************************************************************************************************************************************
included: /Users/art22m/develop/iu/F23-DevOps/ansible/roles/docker/tasks/install_docker.yml for vm01

TASK [docker : Install Docker dependencies] **********************************************************************************************************************************************************************************************************
changed: [vm01]

TASK [docker : Add Docker apt key] *******************************************************************************************************************************************************************************************************************
changed: [vm01]

TASK [docker : Add Docker repository] ****************************************************************************************************************************************************************************************************************
changed: [vm01]

TASK [docker : Install Docker] ***********************************************************************************************************************************************************************************************************************
changed: [vm01]

TASK [docker : include_tasks] ************************************************************************************************************************************************************************************************************************
included: /Users/art22m/develop/iu/F23-DevOps/ansible/roles/docker/tasks/install_compose.yml for vm01

TASK [docker : Install Docker Compose] ***************************************************************************************************************************************************************************************************************
changed: [vm01]

PLAY RECAP *******************************************************************************************************************************************************************************************************************************************
vm01                       : ok=10   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
```

## Output of ansible-inventory
```angular2html
ansible-inventory -i inventory/default_aws_ec2.yml --list    
{
    "_meta": {
        "hostvars": {
            "vm01": {
                "ansible_host": "51.250.20.249",
                "ansible_user": "art22m"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "yandex_vms"
        ]
    },
    "yandex_vms": {
        "hosts": [
            "vm01"
        ]
    }
}
```

## Output of inventory using dynamic inventory

```angular2html
{
    "_meta": {
        "hostvars": {
            "art22m-devops": {
                "ansible_host": "51.250.20.249"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "yacloud"
        ]
    },
    "yacloud": {
        "hosts": [
            "art22m-devops"
        ]
    }
}
```

## Outpit of playbook with deploy
```
PLAY [Deploy Docker] *****************************************************************************************

TASK [Gathering Facts] ***************************************************************************************
ok: [vm01]

TASK [web_app : Get info about container] *******************************************************************
ok: [vm01]

TASK [web_app : Stop the container]
*************************************************************
skipping: [vm01]

TASK [web_app : Remove the container]
***********************************************************
skipping: [vm01]

TASK [web_app : Pull the Docker image]***********************************************************************
changed: [vm01]

TASK [web_app : Run the Docker container] ********************************************************************
changed: [vm01]

PLAY RECAP ***************************************************************************************************
vm01                       : ok=4    changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0
```